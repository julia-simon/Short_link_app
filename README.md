# ShortLinkApp

**ShortLinkApp** — это приложение для создания и управления короткими ссылками с ограничением переходов и временем жизни (TTL).

---

## Краткое описание
Проект реализует сервис коротких ссылок:
- Модели пользователей и ссылок
- Сервисы для работы с ними
- Хранение ссылок в памяти
- Консольный интерфейс для взаимодействия с пользователем

---

## Требования
- **Java 11 или выше**
- **Gradle** для сборки
- Для корректного отображения русских символов в консоли:

> ⚠️ В Run/Debug Configurations → VM options добавить:  
> `-Dfile.encoding=UTF-8`

---

## Установка и запуск
1. Клонируйте репозиторий
2. Соберите проект:

`./gradlew build`

---

## Запустите приложение:

`./gradlew run`

- Главный класс: LinkApp.java
- Метод main запускает приложение.

---

## Конфигурация

### Настройки вынесены в application.properties в корне проекта:

- base.url — базовый URL для всех коротких ссылок
- short.url.length — длина генерируемой короткой части ссылки
- default.ttl.hours — время жизни ссылки по умолчанию (в часах)

---

## Примеры команд

После входа доступны действия (ввод — номер пункта или help):
### 1) Создать новую короткую ссылку

Вводится URL и лимит переходов

Пример:

    Введите URL: `https://example.com`
    Введите лимит переходов: 10
    Короткая ссылка создана: clck.ru/a1B2c3
    Срок жизни: 24 часа, лимит переходов: 10

### 2) Показать все ваши ссылки

Выводит список всех ссылок пользователя с переходами и TTL

Пример:

    clck.ru/a1B2c3 -> https://example.com | Переходов: 0/10 | Просрочено: нет`

### 3) Перейти по короткой ссылке

Вводится короткая ссылка, открывается браузер
Пример:

    Введите короткую ссылку: clck.ru/a1B2c3
    Перенаправление на: https://example.com

Ошибки при переходе:
- Ссылка не найдена
- Лимит переходов исчерпан
- TTL истек

### 4) Редактировать параметры ссылки

Подменю:
- 1 — Изменить лимит переходов
- 2 — Изменить TTL ссылки
- 3 — Назад

Пример изменения лимита:

    Введите короткую ссылку: clck.ru/a1B2c3
    Введите новый лимит переходов: 20
    Лимит успешно обновлён до 20

Пример изменения TTL:

    Введите короткую ссылку: clck.ru/a1B2c3
    Введите новый TTL в часах: 48
    TTL успешно обновлён на 48 часов

### 5) Удалить ссылку

Вводится короткая ссылка для удаления
Пример:

    Введите короткую ссылку: clck.ru/a1B2c3
    Ссылка удалена.

### 6) Выход из программы

    Завершение работы приложения

### help — выводит справку по командам
Поведение при ошибках и валидация

- Проверка формата URL через java.net.URL
- Лимит переходов и TTL должны быть положительными числами
- Редактирование или удаление чужих ссылок запрещено
- Ссылки автоматически удаляются при истечении TTL или при превышении лимита переходов

---

## Структура / архитектура

Проект организован по слоям:

### models — объекты предметной области
- `User` — пользователь
- `Link` — короткая ссылка

### service — бизнес-логика
- `LinkService` — создание, поиск, редактирование и удаление ссылок
- `UserService` — хранение и идентификация текущего пользователя
- `UrlShortenerService` — генерация уникальных коротких ссылок (SHA-256 + Base62)

### cli — консольный интерфейс
- `LinkApp.java` — точка входа и интерфейс пользователя

---

## Работа с данными
- Ссылки хранятся в памяти (`Map<String, Link>`)
- TTL и лимит проверяются при каждом переходе
- Настройки (базовый URL, длина ссылки, TTL) берутся из `application.properties`

---

## Тестирование

- Запуск всех тестов:

`./gradlew test`

Тесты находятся в `src/test/java` и проверяют:

- создание и удаление ссылок
- генерацию уникальных коротких ссылок
- корректность TTL и лимита переходов
- редактирование ссылок владельцем
- автоудаление просроченных ссылок